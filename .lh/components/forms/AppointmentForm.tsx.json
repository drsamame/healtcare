{
    "sourceFile": "components/forms/AppointmentForm.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 107,
            "patches": [
                {
                    "date": 1724107972593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1724108364271,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -41,9 +41,9 @@\n \t\tdefaultValues: {\r\n \t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n \t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n \t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialy : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n \t\t},\r\n \t});\r\n \r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n@@ -137,9 +137,9 @@\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"primaryPhysician\"\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n \t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n \t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n \t\t\t\t\t\t>\r\n \t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n@@ -169,19 +169,12 @@\n \t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n \t\t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n \t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"reason\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Motivo de la cita\"\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n \t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n \t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"note\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Notas\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Tomar medicamento cada 8 horas\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n \t\t\t\t\t\t</div>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n \r\n"
                },
                {
                    "date": 1724110857854,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,208 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Doctors } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.$id}`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment?.$id!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t\ttype,\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t</section>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724111615568,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -72,14 +72,16 @@\n \t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n \t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t};\r\n+\t\t\t\tconsole.log(appointmentData)\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.$id}`\r\n-\t\t\t\t\t);\r\n+\t\t\t\t\tconsole.log(appointment)\r\n+\t\t\t\t\t// router.push(\r\n+\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n+\t\t\t\t\t// );\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n@@ -205,213 +207,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Doctors } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\treason: values.reason!,\r\n-\t\t\t\t\tnote: values.note,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.$id}`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment?.$id!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t\ttype,\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t</section>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724111671666,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,211 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Doctors } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconsole.log(appointmentData)\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment)\r\n+\t\t\t\t\t// router.push(\r\n+\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n+\t\t\t\t\t// );\r\n+\t\t\t\t}\r\n+\t\t\t} \r\n+\t\t\t// else {\r\n+\t\t\t// \tconst appointmentToUpdate = {\r\n+\t\t\t// \t\tuserId,\r\n+\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n+\t\t\t// \t\tappointment: {\r\n+\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n+\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t// \t\t\tstatus: status as Status,\r\n+\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n+\t\t\t// \t\t},\r\n+\t\t\t// \t\ttype,\r\n+\t\t\t// \t};\r\n+\r\n+\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t// \tif (updatedAppointment) {\r\n+\t\t\t// \t\tsetOpen && setOpen(false);\r\n+\t\t\t// \t\tform.reset();\r\n+\t\t\t// \t}\r\n+\t\t\t// }\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t</section>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724111708940,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,8 +46,9 @@\n \t\t},\r\n \t});\r\n \r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tconsole.log('here')\r\n \t\tsetIsLoading(true);\r\n \r\n \t\tlet status;\r\n \r\n@@ -208,214 +209,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Doctors } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconsole.log(appointmentData)\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment)\r\n-\t\t\t\t\t// router.push(\r\n-\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n-\t\t\t\t\t// );\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment?.$id!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t\ttype,\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t</section>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724112181068,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,9 +82,9 @@\n \t\t\t\t\t// router.push(\r\n \t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n \t\t\t\t\t// );\r\n \t\t\t\t}\r\n-\t\t\t} \r\n+\t\t\t}\r\n \t\t\t// else {\r\n \t\t\t// \tconst appointmentToUpdate = {\r\n \t\t\t// \t\tuserId,\r\n \t\t\t// \t\tappointmentId: appointment?.$id!,\r\n"
                },
                {
                    "date": 1724112351335,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,212 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Doctors } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tconsole.log('here')\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconsole.log(appointmentData)\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment)\r\n+\t\t\t\t\t// router.push(\r\n+\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n+\t\t\t\t\t// );\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t\t// else {\r\n+\t\t\t// \tconst appointmentToUpdate = {\r\n+\t\t\t// \t\tuserId,\r\n+\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n+\t\t\t// \t\tappointment: {\r\n+\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n+\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t// \t\t\tstatus: status as Status,\r\n+\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n+\t\t\t// \t\t},\r\n+\t\t\t// \t\ttype,\r\n+\t\t\t// \t};\r\n+\r\n+\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t// \tif (updatedAppointment) {\r\n+\t\t\t// \t\tsetOpen && setOpen(false);\r\n+\t\t\t// \t\tform.reset();\r\n+\t\t\t// \t}\r\n+\t\t\t// }\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t</section>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724112367534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,211 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Doctors } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconsole.log(appointmentData)\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment)\r\n+\t\t\t\t\t// router.push(\r\n+\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n+\t\t\t\t\t// );\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t\t// else {\r\n+\t\t\t// \tconst appointmentToUpdate = {\r\n+\t\t\t// \t\tuserId,\r\n+\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n+\t\t\t// \t\tappointment: {\r\n+\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n+\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t// \t\t\tstatus: status as Status,\r\n+\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n+\t\t\t// \t\t},\r\n+\t\t\t// \t\ttype,\r\n+\t\t\t// \t};\r\n+\r\n+\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t// \tif (updatedAppointment) {\r\n+\t\t\t// \t\tsetOpen && setOpen(false);\r\n+\t\t\t// \t\tform.reset();\r\n+\t\t\t// \t}\r\n+\t\t\t// }\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t</section>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724112383919,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,210 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Doctors } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment)\r\n+\t\t\t\t\t// router.push(\r\n+\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n+\t\t\t\t\t// );\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t\t// else {\r\n+\t\t\t// \tconst appointmentToUpdate = {\r\n+\t\t\t// \t\tuserId,\r\n+\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n+\t\t\t// \t\tappointment: {\r\n+\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n+\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t// \t\t\tstatus: status as Status,\r\n+\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n+\t\t\t// \t\t},\r\n+\t\t\t// \t\ttype,\r\n+\t\t\t// \t};\r\n+\r\n+\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t// \tif (updatedAppointment) {\r\n+\t\t\t// \t\tsetOpen && setOpen(false);\r\n+\t\t\t// \t\tform.reset();\r\n+\t\t\t// \t}\r\n+\t\t\t// }\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t</section>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724367165733,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,33 +76,11 @@\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n \t\t\t\t\tconsole.log(appointment)\r\n-\t\t\t\t\t// router.push(\r\n-\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n-\t\t\t\t\t// );\r\n \t\t\t\t}\r\n \t\t\t}\r\n-\t\t\t// else {\r\n-\t\t\t// \tconst appointmentToUpdate = {\r\n-\t\t\t// \t\tuserId,\r\n-\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n-\t\t\t// \t\tappointment: {\r\n-\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n-\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t// \t\t\tstatus: status as Status,\r\n-\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n-\t\t\t// \t\t},\r\n-\t\t\t// \t\ttype,\r\n-\t\t\t// \t};\r\n \r\n-\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t// \tif (updatedAppointment) {\r\n-\t\t\t// \t\tsetOpen && setOpen(false);\r\n-\t\t\t// \t\tform.reset();\r\n-\t\t\t// \t}\r\n-\t\t\t// }\r\n \t\t} catch (e: any) {\r\n \t\t\tconsole.log(e);\r\n \t\t} finally {\r\n \t\t\tsetIsLoading(false);\r\n@@ -207,639 +185,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Doctors } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconsole.log(appointmentData)\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment)\r\n-\t\t\t\t\t// router.push(\r\n-\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n-\t\t\t\t\t// );\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t\t// else {\r\n-\t\t\t// \tconst appointmentToUpdate = {\r\n-\t\t\t// \t\tuserId,\r\n-\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n-\t\t\t// \t\tappointment: {\r\n-\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n-\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t// \t\t\tstatus: status as Status,\r\n-\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n-\t\t\t// \t\t},\r\n-\t\t\t// \t\ttype,\r\n-\t\t\t// \t};\r\n-\r\n-\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t// \tif (updatedAppointment) {\r\n-\t\t\t// \t\tsetOpen && setOpen(false);\r\n-\t\t\t// \t\tform.reset();\r\n-\t\t\t// \t}\r\n-\t\t\t// }\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t</section>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Doctors } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tconsole.log('here')\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconsole.log(appointmentData)\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment)\r\n-\t\t\t\t\t// router.push(\r\n-\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n-\t\t\t\t\t// );\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t\t// else {\r\n-\t\t\t// \tconst appointmentToUpdate = {\r\n-\t\t\t// \t\tuserId,\r\n-\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n-\t\t\t// \t\tappointment: {\r\n-\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n-\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t// \t\t\tstatus: status as Status,\r\n-\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n-\t\t\t// \t\t},\r\n-\t\t\t// \t\ttype,\r\n-\t\t\t// \t};\r\n-\r\n-\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t// \tif (updatedAppointment) {\r\n-\t\t\t// \t\tsetOpen && setOpen(false);\r\n-\t\t\t// \t\tform.reset();\r\n-\t\t\t// \t}\r\n-\t\t\t// }\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t</section>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Doctors } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tconsole.log('here')\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconsole.log(appointmentData)\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment)\r\n-\t\t\t\t\t// router.push(\r\n-\t\t\t\t\t// \t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.id}`\r\n-\t\t\t\t\t// );\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t\t// else {\r\n-\t\t\t// \tconst appointmentToUpdate = {\r\n-\t\t\t// \t\tuserId,\r\n-\t\t\t// \t\tappointmentId: appointment?.$id!,\r\n-\t\t\t// \t\tappointment: {\r\n-\t\t\t// \t\t\tprimaryPhysician: values.primaryPhysician,\r\n-\t\t\t// \t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t// \t\t\tstatus: status as Status,\r\n-\t\t\t// \t\t\tcancellationReason: values.cancellationReason,\r\n-\t\t\t// \t\t},\r\n-\t\t\t// \t\ttype,\r\n-\t\t\t// \t};\r\n-\r\n-\t\t\t// \tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t// \tif (updatedAppointment) {\r\n-\t\t\t// \t\tsetOpen && setOpen(false);\r\n-\t\t\t// \t\tform.reset();\r\n-\t\t\t// \t}\r\n-\t\t\t// }\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t</section>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724367657042,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,12 +75,11 @@\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment)\r\n+\t\t\t\t\tconsole.log(appointment);\r\n \t\t\t\t}\r\n \t\t\t}\r\n-\r\n \t\t} catch (e: any) {\r\n \t\t\tconsole.log(e);\r\n \t\t} finally {\r\n \t\t\tsetIsLoading(false);\r\n@@ -103,18 +102,15 @@\n \treturn (\r\n \t\t<Form {...form}>\r\n \t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n \t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t</section>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n \t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"specialty\"\r\n@@ -135,8 +131,13 @@\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n \t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"schedule\"\r\n"
                },
                {
                    "date": 1724369401696,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,189 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Doctors } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724369789285,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -118,10 +118,10 @@\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione una especialidad\"\r\n \t\t\t\t\t\t>\r\n \t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n \t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n \t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n@@ -186,193 +186,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Doctors } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724369802871,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -119,9 +119,9 @@\n \t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"specialty\"\r\n \t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione una especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n \t\t\t\t\t\t>\r\n \t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n \t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n \t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n"
                },
                {
                    "date": 1724370135981,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,189 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import {  Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724371832854,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,9 +131,9 @@\n \t\t\t\t\t\t\t\t\t\t\theight={32}\r\n \t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n \t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n \t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name} {doctor.price}</p>\r\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n \t\t\t\t\t\t</CustomFormField>\r\n@@ -186,193 +186,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Doctors } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724371853477,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,9 +131,9 @@\n \t\t\t\t\t\t\t\t\t\t\theight={32}\r\n \t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n \t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n \t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name} {doctor.price}</p>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name} | Consulta a S/{doctor.price}</p>\r\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n \t\t\t\t\t\t</CustomFormField>\r\n"
                },
                {
                    "date": 1724371899042,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,9 +131,9 @@\n \t\t\t\t\t\t\t\t\t\t\theight={32}\r\n \t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n \t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n \t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name} | Consulta a S/{doctor.price}</p>\r\n+\t\t\t\t\t\t\t\t\t\t<p>{doctor.name} | Consulta a S/{doctor.price} %{doctor.discount}</p>\r\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n \t\t\t\t\t\t</CustomFormField>\r\n"
                },
                {
                    "date": 1724372006861,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n \tupdateAppointment,\r\n } from '@/lib/actions/appointment.actions';\r\n import { useRouter } from 'next/navigation';\r\n import { SelectItem } from '@/components/ui/select';\r\n-import {  Services } from '@/constants';\r\n+import { Services } from '@/constants';\r\n import Image from 'next/image';\r\n \r\n interface Props {\r\n \tuserId: string;\r\n@@ -131,9 +131,12 @@\n \t\t\t\t\t\t\t\t\t\t\theight={32}\r\n \t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n \t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n \t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>{doctor.name} | Consulta a S/{doctor.price} %{doctor.discount}</p>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}{' '}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && doctor.discount}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n \t\t\t\t\t\t</CustomFormField>\r\n"
                },
                {
                    "date": 1724372020500,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,192 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}{' '}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && doctor.discount}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724372035947,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -189,196 +189,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}{' '}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && doctor.discount}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724372053168,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,192 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}{' '}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && `%` doctor.discount}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724372070264,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -133,9 +133,9 @@\n \t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n \t\t\t\t\t\t\t\t\t\t/>\r\n \t\t\t\t\t\t\t\t\t\t<p>\r\n \t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}{' '}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && `%` doctor.discount}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && ` ${doctor.discount}%`}\r\n \t\t\t\t\t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n@@ -189,196 +189,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}{' '}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && doctor.discount}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724372082000,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,10 +132,10 @@\n \t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n \t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n \t\t\t\t\t\t\t\t\t\t/>\r\n \t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}{' '}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && ` ${doctor.discount}%`}\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && `${doctor.discount}%`}\r\n \t\t\t\t\t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n"
                },
                {
                    "date": 1724372161415,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,192 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && `(con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tshowTimeSelect\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724372170517,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -133,9 +133,10 @@\n \t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n \t\t\t\t\t\t\t\t\t\t/>\r\n \t\t\t\t\t\t\t\t\t\t<p>\r\n \t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && `(con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n \t\t\t\t\t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t\t\t</SelectItem>\r\n \t\t\t\t\t\t\t))}\r\n@@ -189,196 +190,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 && `${doctor.discount}%`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724372245431,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,9 @@\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"schedule\"\r\n \t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n \t\t\t\t\t\t\tshowTimeSelect\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n+\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy\"\r\n \t\t\t\t\t\t></CustomFormField>\r\n \r\n \t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n \t\t\t\t\t\t\t<CustomFormField\r\n"
                },
                {
                    "date": 1724384985947,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -145,9 +145,8 @@\n \t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"schedule\"\r\n \t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tshowTimeSelect\r\n \t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy\"\r\n \t\t\t\t\t\t></CustomFormField>\r\n \r\n \t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n"
                },
                {
                    "date": 1724385040798,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -145,9 +145,9 @@\n \t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"schedule\"\r\n \t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n \t\t\t\t\t\t></CustomFormField>\r\n \r\n \t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n \t\t\t\t\t\t\t<CustomFormField\r\n"
                },
                {
                    "date": 1724385854575,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,193 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tconsole.log(values);\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724386729596,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n \t\t},\r\n \t});\r\n \r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tconsole.log(values);\r\n+\t\tconsole.log(values, type);\r\n \t\tsetIsLoading(true);\r\n \r\n \t\tlet status;\r\n \r\n@@ -190,196 +190,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724387594374,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,8 +78,27 @@\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n \t\t\t\t\tconsole.log(appointment);\r\n \t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment.id!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t\ttype,\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\t//   const updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\t//   if (updatedAppointment) {\r\n+\t\t\t\t// \tsetOpen && setOpen(false);\r\n+\t\t\t\t// \tform.reset();\r\n+\t\t\t\t//   }\r\n \t\t\t}\r\n \t\t} catch (e: any) {\r\n \t\t\tconsole.log(e);\r\n \t\t} finally {\r\n@@ -92,9 +111,9 @@\n \t\tcase 'cancel':\r\n \t\t\tbuttonLabel = 'Cancelar cita';\r\n \t\t\tbreak;\r\n \t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Crear cita';\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n \t\t\tbreak;\r\n \t\tcase 'schedule':\r\n \t\t\tbuttonLabel = 'Agendar cita';\r\n \t\t\tbreak;\r\n"
                },
                {
                    "date": 1724387915617,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,8 +79,9 @@\n \t\t\t\t\tform.reset();\r\n \t\t\t\t\tconsole.log(appointment);\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n+\t\t\t\tconsole.log(appointment)\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n \t\t\t\t\tappointmentId: appointment.id!,\r\n \t\t\t\t\tappointment: {\r\n"
                },
                {
                    "date": 1724388040902,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,17 +79,17 @@\n \t\t\t\t\tform.reset();\r\n \t\t\t\t\tconsole.log(appointment);\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n-\t\t\t\tconsole.log(appointment)\r\n+\t\t\t\tconsole.log(appointment);\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment.id!,\r\n+\t\t\t\t\tappointmentId: appointment!.id!,\r\n \t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo,\r\n \t\t\t\t\t},\r\n \t\t\t\t\ttype,\r\n \t\t\t\t};\r\n \r\n"
                },
                {
                    "date": 1724390537874,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,213 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tconsole.log(values, type);\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t\ttype,\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\t//   if (updatedAppointment) {\r\n+\t\t\t\t// \tsetOpen && setOpen(false);\r\n+\t\t\t\t// \tform.reset();\r\n+\t\t\t\t//   }\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724393443885,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,8 +88,12 @@\n \t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\t\taditionalInfo: values.aditionalInfo,\r\n+\t\t\t\t\t\tid: undefined,\r\n+\t\t\t\t\t\tuserId: undefined,\r\n+\t\t\t\t\t\tcancellationReason: undefined,\r\n+\t\t\t\t\t\tpatient: undefined,\r\n \t\t\t\t\t},\r\n \t\t\t\t\ttype,\r\n \t\t\t\t};\r\n \r\n@@ -210,217 +214,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tconsole.log(values, type);\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t\ttype,\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\t//   const updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\t//   if (updatedAppointment) {\r\n-\t\t\t\t// \tsetOpen && setOpen(false);\r\n-\t\t\t\t// \tform.reset();\r\n-\t\t\t\t//   }\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724394704721,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,213 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tconsole.log(values, type);\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id!,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\t//   if (updatedAppointment) {\r\n+\t\t\t\t// \tsetOpen && setOpen(false);\r\n+\t\t\t\t// \tform.reset();\r\n+\t\t\t\t//   }\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724394903475,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,9 @@\n \t\t\t\t\tappointment: {\r\n \t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo,\r\n+\t\t\t\t\t\taditionalInfo: values!.aditionalInfo,\r\n \t\t\t\t\t},\r\n \t\t\t\t};\r\n \r\n \t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n@@ -210,221 +210,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tconsole.log(values, type);\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo,\r\n-\t\t\t\t\t\tid: undefined,\r\n-\t\t\t\t\t\tuserId: undefined,\r\n-\t\t\t\t\t\tcancellationReason: undefined,\r\n-\t\t\t\t\t\tpatient: undefined,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t\ttype,\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\t//   if (updatedAppointment) {\r\n-\t\t\t\t// \tsetOpen && setOpen(false);\r\n-\t\t\t\t// \tform.reset();\r\n-\t\t\t\t//   }\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724394916462,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,9 @@\n \t\t\t\t\tappointment: {\r\n \t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values!.aditionalInfo,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n \t\t\t\t\t},\r\n \t\t\t\t};\r\n \r\n \t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n"
                },
                {
                    "date": 1724400679953,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,12 +79,11 @@\n \t\t\t\t\tform.reset();\r\n \t\t\t\t\tconsole.log(appointment);\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n-\t\t\t\tconsole.log(appointment);\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id!,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n \t\t\t\t\ttype: type!,\r\n \t\t\t\t\tappointment: {\r\n \t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n"
                },
                {
                    "date": 1724400790317,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,212 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\t// console.log(values, type);\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\t//   if (updatedAppointment) {\r\n+\t\t\t\t// \tsetOpen && setOpen(false);\r\n+\t\t\t\t// \tform.reset();\r\n+\t\t\t\t//   }\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724401912251,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,8 @@\n \t\t},\r\n \t});\r\n \r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\t// console.log(values, type);\r\n \t\tsetIsLoading(true);\r\n \r\n \t\tlet status;\r\n \r\n@@ -93,224 +92,12 @@\n \t\t\t\t};\r\n \r\n \t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n \r\n-\t\t\t\t//   if (updatedAppointment) {\r\n-\t\t\t\t// \tsetOpen && setOpen(false);\r\n-\t\t\t\t// \tform.reset();\r\n-\t\t\t\t//   }\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tconsole.log(values, type);\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n+\t\t\t\t  if (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n \t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\t//   if (updatedAppointment) {\r\n-\t\t\t\t// \tsetOpen && setOpen(false);\r\n-\t\t\t\t// \tform.reset();\r\n-\t\t\t\t//   }\r\n+\t\t\t\t  }\r\n \t\t\t}\r\n \t\t} catch (e: any) {\r\n \t\t\tconsole.log(e);\r\n \t\t} finally {\r\n"
                },
                {
                    "date": 1724403592172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n \ttype,\r\n \tappointment,\r\n \tsetOpen,\r\n }: Props) => {\r\n-\tconst router = useRouter();\r\n+\t\r\n \tconst [isLoading, setIsLoading] = useState(false);\r\n \r\n \tconst appointmentSchema = getAppointmentSchema(type);\r\n \r\n@@ -81,9 +81,9 @@\n \t\t\t} else {\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n \t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\ttype,\r\n \t\t\t\t\tappointment: {\r\n \t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\t\tstatus: status as Status,\r\n@@ -92,12 +92,12 @@\n \t\t\t\t};\r\n \r\n \t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n \r\n-\t\t\t\t  if (updatedAppointment) {\r\n+\t\t\t\tif (updatedAppointment) {\r\n \t\t\t\t\tsetOpen && setOpen(false);\r\n \t\t\t\t\tform.reset();\r\n-\t\t\t\t  }\r\n+\t\t\t\t}\r\n \t\t\t}\r\n \t\t} catch (e: any) {\r\n \t\t\tconsole.log(e);\r\n \t\t} finally {\r\n"
                },
                {
                    "date": 1724404520015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,211 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724404765592,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,9 +40,9 @@\n \t\tresolver: zodResolver(appointmentSchema),\r\n \t\tdefaultValues: {\r\n \t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n \t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n \t\t\tspecialty: appointment ? appointment.specialty : '',\r\n \t\t},\r\n \t});\r\n \r\n@@ -208,215 +208,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\t\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724405182772,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,8 +87,9 @@\n \t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancelationReason: values.cancellationReason!,\r\n \t\t\t\t\t},\r\n \t\t\t\t};\r\n \r\n \t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n"
                },
                {
                    "date": 1724405298400,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,9 +87,9 @@\n \t\t\t\t\t\tspecialty: values.specialty,\r\n \t\t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancelationReason: values.cancellationReason!,\r\n+\t\t\t\t\t\tcancelationReason: values.cancelationReason!,\r\n \t\t\t\t\t},\r\n \t\t\t\t};\r\n \r\n \t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n"
                },
                {
                    "date": 1724405321341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,212 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724461433722,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,8 +76,9 @@\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n \t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t\trouter.push(`/patients/${userId}/new-appointment/success`);\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n@@ -209,216 +210,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancelationReason: values.cancelationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724461481948,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,213 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t\trouter.push(`/patients/${userId}/new-appointment/success`);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724461616050,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -210,217 +210,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t\trouter.push(`/patients/${userId}/new-appointment/success`);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724477417492,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,9 +76,9 @@\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n \t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t\trouter.push(`/patients/${userId}/new-appointment/success`);\r\n+\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n"
                },
                {
                    "date": 1724515605103,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -125,9 +125,9 @@\n \t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n \t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n \t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n \t\t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t</section>\r\n"
                },
                {
                    "date": 1724515632023,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,213 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\tpara poder separar su atención médica\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724515640128,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,9 +127,9 @@\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n \t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n \t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tpara poder separar su atención médica\r\n+\t\t\t\t\t\t\t\tpara separar su atención médica\r\n \t\t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t</section>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n@@ -210,217 +210,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724515661643,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -125,11 +125,11 @@\n \t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la especialidad</h1>\r\n \t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\tpara separar su atención médica\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica\r\n \t\t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t</section>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n"
                },
                {
                    "date": 1724515680083,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,213 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724515740978,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,9 +175,9 @@\n \t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n \t\t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n \t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n \t\t\t\t\t\t\t></CustomFormField>\r\n \t\t\t\t\t\t</div>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n@@ -210,217 +210,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724515763863,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -112,9 +112,9 @@\n \t\tcase 'cancel':\r\n \t\t\tbuttonLabel = 'Cancelar cita';\r\n \t\t\tbreak;\r\n \t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu atención';\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n \t\t\tbreak;\r\n \t\tcase 'schedule':\r\n \t\t\tbuttonLabel = 'Agendar cita';\r\n \t\t\tbreak;\r\n"
                },
                {
                    "date": 1724515772315,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,213 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724515777842,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,213 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\tconsole.log(appointment);\r\n+\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1724781401988,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,9 +75,8 @@\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n \t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n \t\t\t\tconst appointmentToUpdate = {\r\n"
                },
                {
                    "date": 1726520564480,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,9 +75,11 @@\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n \t\t\t\t}\r\n \t\t\t} else {\r\n \t\t\t\tconst appointmentToUpdate = {\r\n \t\t\t\t\tuserId,\r\n@@ -180,162 +182,8 @@\n \t\t\t\t\t\t</div>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n \r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n \t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n@@ -345,56 +193,8 @@\n \t\t\t\t\t\t</section>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n \r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n \t\t\t\t{type === 'cancel' && (\r\n \t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n \t\t\t\t\t\tcontrol={form.control}\r\n@@ -422,217 +222,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\tconsole.log(appointment);\r\n-\t\t\t\t\trouter.push(`/patients/${appointment?.createdId}/new-appointment/success`);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726521414510,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,231 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"identificationDocument\"\r\n+\t\t\t\t\t\t\tlabel=\"Scanned Copy of Identification Document\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726521630059,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -189,9 +189,9 @@\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"identificationDocument\"\r\n-\t\t\t\t\t\t\tlabel=\"Scanned Copy of Identification Document\"\r\n+\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n \t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n \t\t\t\t\t\t\t\t<FormControl>\r\n \t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n \t\t\t\t\t\t\t\t</FormControl>\r\n@@ -228,229 +228,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726522339684,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,8 +63,23 @@\n \t\t\t\tstatus = 'pending';\r\n \t\t\t\tbreak;\r\n \t\t}\r\n \r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (\r\n+\t\t\tvalues.voucherImage &&\r\n+\t\t\tvalues.voucherImage?.length > 0\r\n+\t\t) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n \t\ttry {\r\n \t\t\tif (type === 'create' && patientId) {\r\n \t\t\t\tconst appointmentData = {\r\n \t\t\t\t\tuserId,\r\n@@ -72,8 +87,11 @@\n \t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n \t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage\r\n+\t\t\t\t\t\t? formData\r\n+\t\t\t\t\t\t: undefined,\r\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n@@ -188,9 +206,9 @@\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"identificationDocument\"\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n \t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n \t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n \t\t\t\t\t\t\t\t<FormControl>\r\n \t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n"
                },
                {
                    "date": 1726525905108,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,249 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t},\r\n+});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (\r\n+\t\t\tvalues.voucherImage &&\r\n+\t\t\tvalues.voucherImage?.length > 0\r\n+\t\t) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage\r\n+\t\t\t\t\t\t? formData\r\n+\t\t\t\t\t\t: undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726526961793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -246,253 +246,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (\r\n-\t\t\tvalues.voucherImage &&\r\n-\t\t\tvalues.voucherImage?.length > 0\r\n-\t\t) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage\r\n-\t\t\t\t\t\t? formData\r\n-\t\t\t\t\t\t: undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726527003943,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,247 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tCopia escaneada del yapeo\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726527488916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,257 +201,17 @@\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n \t\t\t\t\t\t\tCopia escaneada del yapeo\r\n \t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t},\r\n-});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (\r\n-\t\t\tvalues.voucherImage &&\r\n-\t\t\tvalues.voucherImage?.length > 0\r\n-\t\t) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage\r\n-\t\t\t\t\t\t? formData\r\n-\t\t\t\t\t\t: undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpg\"\r\n+\t\t\t\t\t\t\t\twidth={80}\r\n+\t\t\t\t\t\t\t\theight={80}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n \t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"voucherImage\"\r\n"
                },
                {
                    "date": 1726527558359,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,256 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYapea al siguiente cóðigo qr para separar tu atención\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={80}\r\n+\t\t\t\t\t\t\t\theight={80}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726527565272,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,256 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYapea al siguiente cóðigo qr para separar tu atención\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726530039836,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,256 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA O PLINEA escaneando el siguiente código QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726530872844,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -198,9 +198,9 @@\n \t\t\t\t)}\r\n \r\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n \t\t\t\t\t\t\tYAPEA O PLINEA escaneando el siguiente código QR:\r\n \t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t<div>\r\n \t\t\t\t\t\t\t<Image\r\n@@ -253,772 +253,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYapea al siguiente cóðigo qr para separar tu atención\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYapea al siguiente cóðigo qr para separar tu atención\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={80}\r\n-\t\t\t\t\t\t\t\theight={80}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tCopia escaneada del yapeo\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpg\"\r\n-\t\t\t\t\t\t\t\twidth={80}\r\n-\t\t\t\t\t\t\t\theight={80}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726530915998,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -190,9 +190,9 @@\n \t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n \t\t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n \t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Dolor de cabeza intenso\"'\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n \t\t\t\t\t\t\t></CustomFormField>\r\n \t\t\t\t\t\t</div>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n"
                },
                {
                    "date": 1726530927721,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,256 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726530959905,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -214,9 +214,9 @@\n \t\t\t\t\t\t<CustomFormField\r\n \t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n \t\t\t\t\t\t\tcontrol={form.control}\r\n \t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n \t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n \t\t\t\t\t\t\t\t<FormControl>\r\n \t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n \t\t\t\t\t\t\t\t</FormControl>\r\n@@ -253,260 +253,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA O PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Copia escaneada del yapeo\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726535261479,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,8 +43,9 @@\n \t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n \t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n \t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n \t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t\tvoucherImage: [],\r\n \t\t},\r\n \t});\r\n \r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n"
                },
                {
                    "date": 1726740572537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,257 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t\tvoucherImage: [],\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader formats={ACCEPTED_IMAGE_TYPES} files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726740813721,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,8 +201,9 @@\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n \t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n+\t\t\t\t\t\t\t{JSON.stringify(form)}\r\n \t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t<div>\r\n \t\t\t\t\t\t\t<Image\r\n \t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n@@ -254,261 +255,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t\tvoucherImage: [],\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726740894487,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,8 +47,10 @@\n \t\t\tvoucherImage: [],\r\n \t\t},\r\n \t});\r\n \r\n+\tconsole.log(form)\r\n+\r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n \t\tsetIsLoading(true);\r\n \r\n \t\tlet status;\r\n"
                },
                {
                    "date": 1726740955900,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n \t\t\tvoucherImage: [],\r\n \t\t},\r\n \t});\r\n \r\n-\tconsole.log(form)\r\n+\tconsole.log(form.getValues())\r\n \r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n \t\tsetIsLoading(true);\r\n \r\n"
                },
                {
                    "date": 1726740973514,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -203,9 +203,9 @@\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n \t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t\t{JSON.stringify(form)}\r\n+\t\t\t\t\t\t\t{JSON.stringify(form.getValues)}\r\n \t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t<div>\r\n \t\t\t\t\t\t\t<Image\r\n \t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n"
                },
                {
                    "date": 1726741136890,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,260 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t\tvoucherImage: [],\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tconsole.log(form.getValues())\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n+\t\t\t\t\t\t\t{JSON.stringify(form.watch())}\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader formats={ACCEPTED_IMAGE_TYPES} files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726741242015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -203,9 +203,9 @@\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n \t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t\t{JSON.stringify(form.watch())}\r\n+\t\t\t\t\t\t\t{JSON.stringify(Services.find(el => el.name === form.watch('specialty')))}\r\n \t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t<div>\r\n \t\t\t\t\t\t\t<Image\r\n \t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n@@ -257,264 +257,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t\tvoucherImage: [],\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tconsole.log(form.getValues())\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t\t{JSON.stringify(form.getValues)}\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader formats={ACCEPTED_IMAGE_TYPES} files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726741256017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,260 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t\tvoucherImage: [],\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tconsole.log(form.getValues())\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n+\t\t\t\t\t\t\t{JSON.stringify(Services.find(el => el.name === form.watch('specialty'))?.price)}\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader formats={ACCEPTED_IMAGE_TYPES} files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726741338033,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,10 +47,8 @@\n \t\t\tvoucherImage: [],\r\n \t\t},\r\n \t});\r\n \r\n-\tconsole.log(form.getValues())\r\n-\r\n \tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n \t\tsetIsLoading(true);\r\n \r\n \t\tlet status;\r\n@@ -137,268 +135,12 @@\n \t\t\tbuttonLabel = 'Agendar cita';\r\n \t\t\tbreak;\r\n \t}\r\n \r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n \r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t\t{JSON.stringify(Services.find(el => el.name === form.watch('specialty'))?.price)}\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader formats={ACCEPTED_IMAGE_TYPES} files={field.value} onChange={field.onChange} />\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t\tvoucherImage: [],\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tconsole.log(form.getValues())\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n \treturn (\r\n \t\t<Form {...form}>\r\n \t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n \t\t\t\t{type === 'create' && (\r\n@@ -463,9 +205,9 @@\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n \t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t\t{JSON.stringify(Services.find(el => el.name === form.watch('specialty')))}\r\n+\t\t\t\t\t\t\t{JSON.stringify(selectedSpecialtyPrice)}\r\n \t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t<div>\r\n \t\t\t\t\t\t\t<Image\r\n \t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n@@ -481,9 +223,13 @@\n \t\t\t\t\t\t\tname=\"voucherImage\"\r\n \t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n \t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n \t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader formats={ACCEPTED_IMAGE_TYPES} files={field.value} onChange={field.onChange} />\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n \t\t\t\t\t\t\t\t</FormControl>\r\n \t\t\t\t\t\t\t)}\r\n \t\t\t\t\t\t/>\r\n \t\t\t\t\t</>\r\n"
                },
                {
                    "date": 1726741402394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -204,10 +204,10 @@\n \r\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n \t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA escaneando el siguiente código QR:\r\n-\t\t\t\t\t\t\t{JSON.stringify(selectedSpecialtyPrice)}\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n \t\t\t\t\t\t</p>\r\n \t\t\t\t\t\t<div>\r\n \t\t\t\t\t\t\t<Image\r\n \t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n"
                },
                {
                    "date": 1726770030018,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,8 +63,9 @@\n \t\t\tdefault:\r\n \t\t\t\tstatus = 'pending';\r\n \t\t\t\tbreak;\r\n \t\t}\r\n+\t\tconsole.log(values)\r\n \r\n \t\t// Store file info in form data as\r\n \t\tlet formData;\r\n \t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n"
                },
                {
                    "date": 1726770190559,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n \t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n \t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage ? formData : undefined,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n"
                },
                {
                    "date": 1726771886774,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n \t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n \t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? [formData] : undefined,\r\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n"
                },
                {
                    "date": 1726772700630,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n \t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n \t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? [formData] : undefined,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? values.voucherImage[0] : undefined,\r\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n"
                },
                {
                    "date": 1726772705949,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,18 +66,18 @@\n \t\t}\r\n \t\tconsole.log(values)\r\n \r\n \t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n+\t\t// let formData;\r\n+\t\t// if (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t// \tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t// \t\ttype: values.voucherImage[0].type,\r\n+\t\t// \t});\r\n \r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n+\t\t// \tformData = new FormData();\r\n+\t\t// \tformData.append('blobFile', blobFile);\r\n+\t\t// \tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t// }\r\n \r\n \t\ttry {\r\n \t\t\tif (type === 'create' && patientId) {\r\n \t\t\t\tconst appointmentData = {\r\n"
                },
                {
                    "date": 1726772778456,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,18 +66,18 @@\n \t\t}\r\n \t\tconsole.log(values)\r\n \r\n \t\t// Store file info in form data as\r\n-\t\t// let formData;\r\n-\t\t// if (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t// \tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t// \t\ttype: values.voucherImage[0].type,\r\n-\t\t// \t});\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n \r\n-\t\t// \tformData = new FormData();\r\n-\t\t// \tformData.append('blobFile', blobFile);\r\n-\t\t// \tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t// }\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n \r\n \t\ttry {\r\n \t\t\tif (type === 'create' && patientId) {\r\n \t\t\t\tconst appointmentData = {\r\n"
                },
                {
                    "date": 1726772883590,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n \t\t\t\t\tschedule: new Date(values.schedule),\r\n \t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n \t\t\t\t\tstatus: status as Status,\r\n \t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? values.voucherImage[0] : undefined,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n \t\t\t\t};\r\n \t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n \t\t\t\tif (appointment) {\r\n \t\t\t\t\tform.reset();\r\n"
                },
                {
                    "date": 1726772902862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,267 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t\tvoucherImage: [],\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values)\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726790055710,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,266 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values)\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726815886869,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,269 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values)\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<p className='text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70'>voucher</p> \r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726816059620,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,9 +62,9 @@\n \t\t\tdefault:\r\n \t\t\t\tstatus = 'pending';\r\n \t\t\t\tbreak;\r\n \t\t}\r\n-\t\tconsole.log(values)\r\n+\t\tconsole.log(values);\r\n \r\n \t\t// Store file info in form data as\r\n \t\tlet formData;\r\n \t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n@@ -199,9 +199,19 @@\n \t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n \t\t\t\t\t\t\t></CustomFormField>\r\n \t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<p className='text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70'>voucher</p> \r\n+\t\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\t\tVoucher\r\n+\t\t\t\t\t\t\t</p>{JSON.stringify(appointment)}\r\n+\t\t\t\t\t\t\t<a\r\n+\t\t\t\t\t\t\t\thref={url}\r\n+\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n+\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n+\t\t\t\t\t\t\t\tclassName=\"hover:text-blue-600\"\r\n+\t\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t\tVer comprobante de pago\r\n+\t\t\t\t\t\t\t</a>\r\n \t\t\t\t\t\t</div>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n \r\n@@ -266,804 +276,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values)\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t\tvoucherImage: [],\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values)\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t\tvoucherImage: [],\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values)\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726816089445,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -203,9 +203,9 @@\n \t\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n \t\t\t\t\t\t\t\tVoucher\r\n \t\t\t\t\t\t\t</p>{JSON.stringify(appointment)}\r\n \t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\thref={url}\r\n+\t\t\t\t\t\t\t\t// href={url}\r\n \t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n \t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n \t\t\t\t\t\t\t\tclassName=\"hover:text-blue-600\"\r\n \t\t\t\t\t\t\t>\r\n"
                },
                {
                    "date": 1726816284339,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,279 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values);\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\t\tVoucher\r\n+\t\t\t\t\t\t\t</p>{JSON.stringify(appointment)}\r\n+\t\t\t\t\t\t\t<a\r\n+\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n+\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n+\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n+\t\t\t\t\t\t\t\tclassName=\"hover:text-blue-600\"\r\n+\t\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t\tVer comprobante de pago\r\n+\t\t\t\t\t\t\t</a>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726816316362,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,277 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values);\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t{JSON.stringify(appointment)}\r\n+\t\t\t\t\t\t\t<a\r\n+\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\r\n+\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n+\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n+\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n+\t\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t\tVer comprobante de pago\r\n+\t\t\t\t\t\t\t</a>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726816511819,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,276 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values);\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<a\r\n+\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed underline peer-disabled:opacity-70\"\r\n+\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n+\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n+\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n+\t\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t\tVer comprobante de pago\r\n+\t\t\t\t\t\t\t</a>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726816523929,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,276 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values);\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<a\r\n+\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none underline peer-disabled:opacity-70\"\r\n+\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n+\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n+\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n+\t\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t\tVer comprobante de pago\r\n+\t\t\t\t\t\t\t</a>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726816530285,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -200,9 +200,9 @@\n \t\t\t\t\t\t\t></CustomFormField>\r\n \t\t\t\t\t\t</div>\r\n \t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n \t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none underline peer-disabled:opacity-70\"\r\n+\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none underline\"\r\n \t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n \t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n \t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n \t\t\t\t\t\t\t>\r\n@@ -273,1115 +273,4 @@\n \t);\r\n };\r\n \r\n export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values);\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed underline peer-disabled:opacity-70\"\r\n-\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n-\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n-\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n-\t\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t\tVer comprobante de pago\r\n-\t\t\t\t\t\t\t</a>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values);\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t{JSON.stringify(appointment)}\r\n-\t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\r\n-\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n-\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n-\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n-\t\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t\tVer comprobante de pago\r\n-\t\t\t\t\t\t\t</a>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values);\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\t\tVoucher\r\n-\t\t\t\t\t\t\t</p>{JSON.stringify(appointment)}\r\n-\t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n-\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n-\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n-\t\t\t\t\t\t\t\tclassName=\"hover:text-blue-600\"\r\n-\t\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t\tVer comprobante de pago\r\n-\t\t\t\t\t\t\t</a>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values);\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n-\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<p className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\t\tVoucher\r\n-\t\t\t\t\t\t\t</p>{JSON.stringify(appointment)}\r\n-\t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\t// href={url}\r\n-\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n-\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n-\t\t\t\t\t\t\t\tclassName=\"hover:text-blue-600\"\r\n-\t\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t\tVer comprobante de pago\r\n-\t\t\t\t\t\t\t</a>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n"
                },
                {
                    "date": 1726816541194,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,276 @@\n+'use client';\r\n+import { zodResolver } from '@hookform/resolvers/zod';\r\n+import { useForm } from 'react-hook-form';\r\n+import { z } from 'zod';\r\n+import { Form, FormControl } from '@/components/ui/form';\r\n+import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n+import SubmitButton from '../SubmitButton';\r\n+import { Dispatch, SetStateAction, useState } from 'react';\r\n+import { getAppointmentSchema } from '@/lib/validation';\r\n+import {\r\n+\tcreateAppointment,\r\n+\tupdateAppointment,\r\n+} from '@/lib/actions/appointment.actions';\r\n+import { useRouter } from 'next/navigation';\r\n+import { SelectItem } from '@/components/ui/select';\r\n+import { Services } from '@/constants';\r\n+import Image from 'next/image';\r\n+import { FileUploader } from '../FileUploader';\r\n+import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n+interface Props {\r\n+\tuserId: string;\r\n+\tpatientId: string;\r\n+\tappointment?: Appointment;\r\n+\ttype: 'create' | 'cancel' | 'schedule';\r\n+\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n+}\r\n+\r\n+const AppointmentForm = ({\r\n+\tuserId,\r\n+\tpatientId,\r\n+\ttype,\r\n+\tappointment,\r\n+\tsetOpen,\r\n+}: Props) => {\r\n+\tconst router = useRouter();\r\n+\tconst [isLoading, setIsLoading] = useState(false);\r\n+\r\n+\tconst appointmentSchema = getAppointmentSchema(type);\r\n+\r\n+\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n+\t\tresolver: zodResolver(appointmentSchema),\r\n+\t\tdefaultValues: {\r\n+\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n+\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n+\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n+\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n+\t\t},\r\n+\t});\r\n+\r\n+\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n+\t\tsetIsLoading(true);\r\n+\r\n+\t\tlet status;\r\n+\r\n+\t\tswitch (type) {\r\n+\t\t\tcase 'cancel':\r\n+\t\t\t\tstatus = 'cancelled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tcase 'schedule':\r\n+\t\t\t\tstatus = 'scheduled';\r\n+\t\t\t\tbreak;\r\n+\t\t\tdefault:\r\n+\t\t\t\tstatus = 'pending';\r\n+\t\t\t\tbreak;\r\n+\t\t}\r\n+\t\tconsole.log(values);\r\n+\r\n+\t\t// Store file info in form data as\r\n+\t\tlet formData;\r\n+\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n+\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n+\t\t\t\ttype: values.voucherImage[0].type,\r\n+\t\t\t});\r\n+\r\n+\t\t\tformData = new FormData();\r\n+\t\t\tformData.append('blobFile', blobFile);\r\n+\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n+\t\t}\r\n+\r\n+\t\ttry {\r\n+\t\t\tif (type === 'create' && patientId) {\r\n+\t\t\t\tconst appointmentData = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tpatient: patientId,\r\n+\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n+\t\t\t\t};\r\n+\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n+\t\t\t\tif (appointment) {\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t\trouter.push(\r\n+\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n+\t\t\t\t\t);\r\n+\t\t\t\t}\r\n+\t\t\t} else {\r\n+\t\t\t\tconst appointmentToUpdate = {\r\n+\t\t\t\t\tuserId,\r\n+\t\t\t\t\tappointmentId: appointment!.id,\r\n+\t\t\t\t\ttype: type!,\r\n+\t\t\t\t\tappointment: {\r\n+\t\t\t\t\t\tspecialty: values.specialty,\r\n+\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n+\t\t\t\t\t\tstatus: status as Status,\r\n+\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n+\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n+\t\t\t\t\t},\r\n+\t\t\t\t};\r\n+\r\n+\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n+\r\n+\t\t\t\tif (updatedAppointment) {\r\n+\t\t\t\t\tsetOpen && setOpen(false);\r\n+\t\t\t\t\tform.reset();\r\n+\t\t\t\t}\r\n+\t\t\t}\r\n+\t\t} catch (e: any) {\r\n+\t\t\tconsole.log(e);\r\n+\t\t} finally {\r\n+\t\t\tsetIsLoading(false);\r\n+\t\t}\r\n+\t}\r\n+\tlet buttonLabel;\r\n+\r\n+\tswitch (type) {\r\n+\t\tcase 'cancel':\r\n+\t\t\tbuttonLabel = 'Cancelar cita';\r\n+\t\t\tbreak;\r\n+\t\tcase 'create':\r\n+\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n+\t\t\tbreak;\r\n+\t\tcase 'schedule':\r\n+\t\t\tbuttonLabel = 'Agendar cita';\r\n+\t\t\tbreak;\r\n+\t}\r\n+\r\n+\tconst selectedSpecialtyPrice = Services.find(\r\n+\t\t(el) => el.name === form.watch('specialty')\r\n+\t)?.price;\r\n+\r\n+\treturn (\r\n+\t\t<Form {...form}>\r\n+\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n+\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n+\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n+\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n+\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t</section>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type !== 'cancel' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"specialty\"\r\n+\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n+\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n+\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n+\t\t\t\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n+\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n+\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n+\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n+\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n+\t\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t\t\t<p>\r\n+\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n+\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n+\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n+\t\t\t\t\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t</SelectItem>\r\n+\t\t\t\t\t\t\t))}\r\n+\t\t\t\t\t\t</CustomFormField>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"schedule\"\r\n+\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n+\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n+\t\t\t\t\t\t></CustomFormField>\r\n+\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n+\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n+\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n+\t\t\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t\t<a\r\n+\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none underline\"\r\n+\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n+\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n+\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n+\t\t\t\t\t\t\t>\r\n+\t\t\t\t\t\t\t\tVer comprobante de pago\r\n+\t\t\t\t\t\t\t</a>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'create' && (\r\n+\t\t\t\t\t<>\r\n+\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n+\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n+\t\t\t\t\t\t\tcódigo QR:\r\n+\t\t\t\t\t\t</p>\r\n+\t\t\t\t\t\t<div>\r\n+\t\t\t\t\t\t\t<Image\r\n+\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n+\t\t\t\t\t\t\t\twidth={180}\r\n+\t\t\t\t\t\t\t\theight={180}\r\n+\t\t\t\t\t\t\t\talt=\"patient\"\r\n+\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n+\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n+\t\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\t\tname=\"voucherImage\"\r\n+\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n+\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n+\t\t\t\t\t\t\t\t<FormControl>\r\n+\t\t\t\t\t\t\t\t\t<FileUploader\r\n+\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n+\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n+\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n+\t\t\t\t\t\t\t\t\t/>\r\n+\t\t\t\t\t\t\t\t</FormControl>\r\n+\t\t\t\t\t\t\t)}\r\n+\t\t\t\t\t\t/>\r\n+\t\t\t\t\t</>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t{type === 'cancel' && (\r\n+\t\t\t\t\t<CustomFormField\r\n+\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n+\t\t\t\t\t\tcontrol={form.control}\r\n+\t\t\t\t\t\tname=\"cancellationReason\"\r\n+\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n+\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n+\t\t\t\t\t></CustomFormField>\r\n+\t\t\t\t)}\r\n+\r\n+\t\t\t\t<SubmitButton\r\n+\t\t\t\t\tclassName={`${\r\n+\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n+\t\t\t\t\t} w-full`}\r\n+\t\t\t\t\tisLoading={isLoading}\r\n+\t\t\t\t>\r\n+\t\t\t\t\t{buttonLabel}\r\n+\t\t\t\t</SubmitButton>\r\n+\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n+\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n+\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n+\t\t\t\t\t</p>\r\n+\t\t\t\t)}\r\n+\t\t\t</form>\r\n+\t\t</Form>\r\n+\t);\r\n+};\r\n+\r\n+export default AppointmentForm;\r\n"
                },
                {
                    "date": 1727220039967,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -198,295 +198,21 @@\n \t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n \t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n \t\t\t\t\t\t\t></CustomFormField>\r\n \t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none underline\"\r\n-\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n-\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n-\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n-\t\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t\tVer comprobante de pago\r\n-\t\t\t\t\t\t\t</a>\r\n-\t\t\t\t\t\t</div>\r\n \t\t\t\t\t</>\r\n \t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<p className=\"text-sm font-semibold leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">\r\n-\t\t\t\t\t\t\tYAPEA o PLINEA S/.{selectedSpecialtyPrice} escaneando el siguiente\r\n-\t\t\t\t\t\t\tcódigo QR:\r\n-\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t<div>\r\n-\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\tsrc=\"/assets/images/qryape.jpeg\"\r\n-\t\t\t\t\t\t\t\twidth={180}\r\n-\t\t\t\t\t\t\t\theight={180}\r\n-\t\t\t\t\t\t\t\talt=\"patient\"\r\n-\t\t\t\t\t\t\t\tclassName=\"side-image max-w-[390px]\"\r\n-\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SKELETON}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"voucherImage\"\r\n-\t\t\t\t\t\t\tlabel=\"Adjunta una foto o captura de pantalla del YAPE o PLIN realizado:\"\r\n-\t\t\t\t\t\t\trenderSkeleton={(field) => (\r\n-\t\t\t\t\t\t\t\t<FormControl>\r\n-\t\t\t\t\t\t\t\t\t<FileUploader\r\n-\t\t\t\t\t\t\t\t\t\tformats={ACCEPTED_IMAGE_TYPES}\r\n-\t\t\t\t\t\t\t\t\t\tfiles={field.value}\r\n-\t\t\t\t\t\t\t\t\t\tonChange={field.onChange}\r\n-\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t</FormControl>\r\n-\t\t\t\t\t\t\t)}\r\n-\t\t\t\t\t\t/>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type === 'cancel' && (\r\n-\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\tname=\"cancellationReason\"\r\n-\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n-\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n-\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t<SubmitButton\r\n-\t\t\t\t\tclassName={`${\r\n-\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n-\t\t\t\t\t} w-full`}\r\n-\t\t\t\t\tisLoading={isLoading}\r\n-\t\t\t\t>\r\n-\t\t\t\t\t{buttonLabel}\r\n-\t\t\t\t</SubmitButton>\r\n-\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n-\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n-\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n-\t\t\t\t\t</p>\r\n-\t\t\t\t)}\r\n-\t\t\t</form>\r\n-\t\t</Form>\r\n-\t);\r\n-};\r\n-\r\n-export default AppointmentForm;\r\n-'use client';\r\n-import { zodResolver } from '@hookform/resolvers/zod';\r\n-import { useForm } from 'react-hook-form';\r\n-import { z } from 'zod';\r\n-import { Form, FormControl } from '@/components/ui/form';\r\n-import CustomFormField, { FormFieldType } from '../CustomFormField';\r\n-import SubmitButton from '../SubmitButton';\r\n-import { Dispatch, SetStateAction, useState } from 'react';\r\n-import { getAppointmentSchema } from '@/lib/validation';\r\n-import {\r\n-\tcreateAppointment,\r\n-\tupdateAppointment,\r\n-} from '@/lib/actions/appointment.actions';\r\n-import { useRouter } from 'next/navigation';\r\n-import { SelectItem } from '@/components/ui/select';\r\n-import { Services } from '@/constants';\r\n-import Image from 'next/image';\r\n-import { FileUploader } from '../FileUploader';\r\n-import { ACCEPTED_IMAGE_TYPES } from '@/lib/validation';\r\n-interface Props {\r\n-\tuserId: string;\r\n-\tpatientId: string;\r\n-\tappointment?: Appointment;\r\n-\ttype: 'create' | 'cancel' | 'schedule';\r\n-\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n-}\r\n-\r\n-const AppointmentForm = ({\r\n-\tuserId,\r\n-\tpatientId,\r\n-\ttype,\r\n-\tappointment,\r\n-\tsetOpen,\r\n-}: Props) => {\r\n-\tconst router = useRouter();\r\n-\tconst [isLoading, setIsLoading] = useState(false);\r\n-\r\n-\tconst appointmentSchema = getAppointmentSchema(type);\r\n-\r\n-\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n-\t\tresolver: zodResolver(appointmentSchema),\r\n-\t\tdefaultValues: {\r\n-\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n-\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n-\t\t\taditionalInfo: appointment ? appointment.aditionalInfo! : '',\r\n-\t\t\tspecialty: appointment ? appointment.specialty : '',\r\n-\t\t},\r\n-\t});\r\n-\r\n-\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n-\t\tsetIsLoading(true);\r\n-\r\n-\t\tlet status;\r\n-\r\n-\t\tswitch (type) {\r\n-\t\t\tcase 'cancel':\r\n-\t\t\t\tstatus = 'cancelled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tcase 'schedule':\r\n-\t\t\t\tstatus = 'scheduled';\r\n-\t\t\t\tbreak;\r\n-\t\t\tdefault:\r\n-\t\t\t\tstatus = 'pending';\r\n-\t\t\t\tbreak;\r\n-\t\t}\r\n-\t\tconsole.log(values);\r\n-\r\n-\t\t// Store file info in form data as\r\n-\t\tlet formData;\r\n-\t\tif (values.voucherImage && values.voucherImage?.length > 0) {\r\n-\t\t\tconst blobFile = new Blob([values.voucherImage[0]], {\r\n-\t\t\t\ttype: values.voucherImage[0].type,\r\n-\t\t\t});\r\n-\r\n-\t\t\tformData = new FormData();\r\n-\t\t\tformData.append('blobFile', blobFile);\r\n-\t\t\tformData.append('fileName', values.voucherImage[0].name);\r\n-\t\t}\r\n-\r\n-\t\ttry {\r\n-\t\t\tif (type === 'create' && patientId) {\r\n-\t\t\t\tconst appointmentData = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tpatient: patientId,\r\n-\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\tvoucherImage: values.voucherImage[0] ? formData : undefined,\r\n-\t\t\t\t};\r\n-\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n-\t\t\t\tif (appointment) {\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t\trouter.push(\r\n-\t\t\t\t\t\t`/patients/${appointment?.createdId}/new-appointment/success`\r\n-\t\t\t\t\t);\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\tconst appointmentToUpdate = {\r\n-\t\t\t\t\tuserId,\r\n-\t\t\t\t\tappointmentId: appointment!.id,\r\n-\t\t\t\t\ttype: type!,\r\n-\t\t\t\t\tappointment: {\r\n-\t\t\t\t\t\tspecialty: values.specialty,\r\n-\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n-\t\t\t\t\t\tstatus: status as Status,\r\n-\t\t\t\t\t\taditionalInfo: values.aditionalInfo!,\r\n-\t\t\t\t\t\tcancellationReason: values.cancellationReason!,\r\n-\t\t\t\t\t},\r\n-\t\t\t\t};\r\n-\r\n-\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n-\r\n-\t\t\t\tif (updatedAppointment) {\r\n-\t\t\t\t\tsetOpen && setOpen(false);\r\n-\t\t\t\t\tform.reset();\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t} catch (e: any) {\r\n-\t\t\tconsole.log(e);\r\n-\t\t} finally {\r\n-\t\t\tsetIsLoading(false);\r\n-\t\t}\r\n-\t}\r\n-\tlet buttonLabel;\r\n-\r\n-\tswitch (type) {\r\n-\t\tcase 'cancel':\r\n-\t\t\tbuttonLabel = 'Cancelar cita';\r\n-\t\t\tbreak;\r\n-\t\tcase 'create':\r\n-\t\t\tbuttonLabel = 'Separa Tu Atención';\r\n-\t\t\tbreak;\r\n-\t\tcase 'schedule':\r\n-\t\t\tbuttonLabel = 'Agendar cita';\r\n-\t\t\tbreak;\r\n-\t}\r\n-\r\n-\tconst selectedSpecialtyPrice = Services.find(\r\n-\t\t(el) => el.name === form.watch('specialty')\r\n-\t)?.price;\r\n-\r\n-\treturn (\r\n-\t\t<Form {...form}>\r\n-\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n-\t\t\t\t{type === 'create' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n-\t\t\t\t\t\t\t<h1 className=\"header\">Seleccione la Especialidad</h1>\r\n-\t\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n-\t\t\t\t\t\t\t\ten que desea separar su atención médica.\r\n-\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t</section>\r\n-\t\t\t\t\t</>\r\n-\t\t\t\t)}\r\n-\r\n-\t\t\t\t{type !== 'cancel' && (\r\n-\t\t\t\t\t<>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"specialty\"\r\n-\t\t\t\t\t\t\tlabel=\"Especialidad\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Seleccione la especialidad para su consulta\"\r\n+\t\t\t\t{type === 'schedule' && (\r\n+\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n+\t\t\t\t\t\t<a\r\n+\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none underline\"\r\n+\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n+\t\t\t\t\t\t\ttarget=\"_blank\"\r\n+\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n \t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t{Services.map((doctor, i) => (\r\n-\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n-\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n-\t\t\t\t\t\t\t\t\t\t<Image\r\n-\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n-\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n-\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n-\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n-\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n-\t\t\t\t\t\t\t\t\t\t/>\r\n-\t\t\t\t\t\t\t\t\t\t<p>\r\n-\t\t\t\t\t\t\t\t\t\t\t{doctor.name} | Consulta a S/{doctor.price}\r\n-\t\t\t\t\t\t\t\t\t\t\t{Number(doctor.discount) > 0 &&\r\n-\t\t\t\t\t\t\t\t\t\t\t\t` (con ${doctor.discount}% dscto.)`}\r\n-\t\t\t\t\t\t\t\t\t\t</p>\r\n-\t\t\t\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t\t\t</SelectItem>\r\n-\t\t\t\t\t\t\t))}\r\n-\t\t\t\t\t\t</CustomFormField>\r\n-\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n-\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\tname=\"schedule\"\r\n-\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n-\t\t\t\t\t\t\tdateFormat=\"dd/MM/yyyy\"\r\n-\t\t\t\t\t\t></CustomFormField>\r\n-\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<CustomFormField\r\n-\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n-\t\t\t\t\t\t\t\tcontrol={form.control}\r\n-\t\t\t\t\t\t\t\tname=\"aditionalInfo\"\r\n-\t\t\t\t\t\t\t\tlabel=\"Observación adicional\"\r\n-\t\t\t\t\t\t\t\tplaceholder='Ejemplo: \"Deseo atención en el turno mañana. Deseo ser atendido por el doctor Sánchez Valera\"'\r\n-\t\t\t\t\t\t\t></CustomFormField>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n-\t\t\t\t\t\t\t<a\r\n-\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium leading-none underline\"\r\n-\t\t\t\t\t\t\t\thref={appointment?.voucherDocumentUrl}\r\n-\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n-\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n-\t\t\t\t\t\t\t>\r\n-\t\t\t\t\t\t\t\tVer comprobante de pago\r\n-\t\t\t\t\t\t\t</a>\r\n-\t\t\t\t\t\t</div>\r\n-\t\t\t\t\t</>\r\n+\t\t\t\t\t\t\tVer comprobante de pago\r\n+\t\t\t\t\t\t</a>\r\n+\t\t\t\t\t</div>\r\n \t\t\t\t)}\r\n \r\n \t\t\t\t{type === 'create' && (\r\n \t\t\t\t\t<>\r\n"
                }
            ],
            "date": 1724107972593,
            "name": "Commit-0",
            "content": "'use client';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport { useForm } from 'react-hook-form';\r\nimport { z } from 'zod';\r\nimport { Form } from '@/components/ui/form';\r\nimport CustomFormField, { FormFieldType } from '../CustomFormField';\r\nimport SubmitButton from '../SubmitButton';\r\nimport { Dispatch, SetStateAction, useState } from 'react';\r\nimport { getAppointmentSchema } from '@/lib/validation';\r\nimport {\r\n\tcreateAppointment,\r\n\tupdateAppointment,\r\n} from '@/lib/actions/appointment.actions';\r\nimport { useRouter } from 'next/navigation';\r\nimport { SelectItem } from '@/components/ui/select';\r\nimport { Doctors } from '@/constants';\r\nimport Image from 'next/image';\r\n\r\ninterface Props {\r\n\tuserId: string;\r\n\tpatientId: string;\r\n\tappointment?: Appointment;\r\n\ttype: 'create' | 'cancel' | 'schedule';\r\n\tsetOpen?: Dispatch<SetStateAction<boolean>>;\r\n}\r\n\r\nconst AppointmentForm = ({\r\n\tuserId,\r\n\tpatientId,\r\n\ttype,\r\n\tappointment,\r\n\tsetOpen,\r\n}: Props) => {\r\n\tconst router = useRouter();\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tconst appointmentSchema = getAppointmentSchema(type);\r\n\r\n\tconst form = useForm<z.infer<typeof appointmentSchema>>({\r\n\t\tresolver: zodResolver(appointmentSchema),\r\n\t\tdefaultValues: {\r\n\t\t\tcancellationReason: appointment?.cancellationReason || '',\r\n\t\t\tschedule: appointment ? new Date(appointment.schedule) : new Date(),\r\n\t\t\taditionalInfo: appointment ? appointment.aditionalInfo : '',\r\n\t\t\tspecialty: appointment ? appointment.specialy : '',\r\n\t\t},\r\n\t});\r\n\r\n\tasync function onSubmit(values: z.infer<typeof appointmentSchema>) {\r\n\t\tsetIsLoading(true);\r\n\r\n\t\tlet status;\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase 'cancel':\r\n\t\t\t\tstatus = 'cancelled';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'schedule':\r\n\t\t\t\tstatus = 'scheduled';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tstatus = 'pending';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tif (type === 'create' && patientId) {\r\n\t\t\t\tconst appointmentData = {\r\n\t\t\t\t\tuserId,\r\n\t\t\t\t\tpatient: patientId,\r\n\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n\t\t\t\t\tschedule: new Date(values.schedule),\r\n\t\t\t\t\treason: values.reason!,\r\n\t\t\t\t\tnote: values.note,\r\n\t\t\t\t\tstatus: status as Status,\r\n\t\t\t\t};\r\n\t\t\t\tconst appointment = await createAppointment(appointmentData);\r\n\t\t\t\tif (appointment) {\r\n\t\t\t\t\tform.reset();\r\n\t\t\t\t\trouter.push(\r\n\t\t\t\t\t\t`/patients/${userId}/new-appointment/success?appointmentId=${appointment.$id}`\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst appointmentToUpdate = {\r\n\t\t\t\t\tuserId,\r\n\t\t\t\t\tappointmentId: appointment?.$id!,\r\n\t\t\t\t\tappointment: {\r\n\t\t\t\t\t\tprimaryPhysician: values.primaryPhysician,\r\n\t\t\t\t\t\tschedule: new Date(values.schedule),\r\n\t\t\t\t\t\tstatus: status as Status,\r\n\t\t\t\t\t\tcancellationReason: values.cancellationReason,\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttype,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tconst updatedAppointment = await updateAppointment(appointmentToUpdate);\r\n\r\n\t\t\t\tif (updatedAppointment) {\r\n\t\t\t\t\tsetOpen && setOpen(false);\r\n\t\t\t\t\tform.reset();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e: any) {\r\n\t\t\tconsole.log(e);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading(false);\r\n\t\t}\r\n\t}\r\n\tlet buttonLabel;\r\n\r\n\tswitch (type) {\r\n\t\tcase 'cancel':\r\n\t\t\tbuttonLabel = 'Cancelar cita';\r\n\t\t\tbreak;\r\n\t\tcase 'create':\r\n\t\t\tbuttonLabel = 'Crear cita';\r\n\t\t\tbreak;\r\n\t\tcase 'schedule':\r\n\t\t\tbuttonLabel = 'Agendar cita';\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Form {...form}>\r\n\t\t\t<form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6 flex-1\">\r\n\t\t\t\t{type === 'create' && (\r\n\t\t\t\t\t<section className=\"mb-12 space-y-4\">\r\n\t\t\t\t\t\t<h1 className=\"header\">Nueva cita!</h1>\r\n\t\t\t\t\t\t<p className=\"text-dark-700\">\r\n\t\t\t\t\t\t\tSolicita una nueva cita en 10 segundos\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</section>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{type !== 'cancel' && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<CustomFormField\r\n\t\t\t\t\t\t\tfieldType={FormFieldType.SELECT}\r\n\t\t\t\t\t\t\tcontrol={form.control}\r\n\t\t\t\t\t\t\tname=\"primaryPhysician\"\r\n\t\t\t\t\t\t\tlabel=\"Médico primario\"\r\n\t\t\t\t\t\t\tplaceholder=\"Seleccione un médico\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{Doctors.map((doctor, i) => (\r\n\t\t\t\t\t\t\t\t<SelectItem key={doctor.name + i} value={doctor.name}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={doctor.image}\r\n\t\t\t\t\t\t\t\t\t\t\twidth={32}\r\n\t\t\t\t\t\t\t\t\t\t\theight={32}\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"doctor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full border border-dark-500\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<p>{doctor.name}</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</SelectItem>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</CustomFormField>\r\n\t\t\t\t\t\t<CustomFormField\r\n\t\t\t\t\t\t\tfieldType={FormFieldType.DATEPICKER}\r\n\t\t\t\t\t\t\tcontrol={form.control}\r\n\t\t\t\t\t\t\tname=\"schedule\"\r\n\t\t\t\t\t\t\tplaceholder=\"Fecha y Hora de la cita\"\r\n\t\t\t\t\t\t\tshowTimeSelect\r\n\t\t\t\t\t\t\tdateFormat=\"MM/dd/yyyy - h:mm aa\"\r\n\t\t\t\t\t\t></CustomFormField>\r\n\r\n\t\t\t\t\t\t<div className=\"flex flex-col gap-6 xl:flex-row\">\r\n\t\t\t\t\t\t\t<CustomFormField\r\n\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n\t\t\t\t\t\t\t\tcontrol={form.control}\r\n\t\t\t\t\t\t\t\tname=\"reason\"\r\n\t\t\t\t\t\t\t\tlabel=\"Motivo de la cita\"\r\n\t\t\t\t\t\t\t\tplaceholder='Ej. \"Dolor de cabeza intenso\"'\r\n\t\t\t\t\t\t\t></CustomFormField>\r\n\t\t\t\t\t\t\t<CustomFormField\r\n\t\t\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n\t\t\t\t\t\t\t\tcontrol={form.control}\r\n\t\t\t\t\t\t\t\tname=\"note\"\r\n\t\t\t\t\t\t\t\tlabel=\"Notas\"\r\n\t\t\t\t\t\t\t\tplaceholder='Ej. \"Tomar medicamento cada 8 horas\"'\r\n\t\t\t\t\t\t\t></CustomFormField>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{type === 'cancel' && (\r\n\t\t\t\t\t<CustomFormField\r\n\t\t\t\t\t\tfieldType={FormFieldType.TEXTAREA}\r\n\t\t\t\t\t\tcontrol={form.control}\r\n\t\t\t\t\t\tname=\"cancellationReason\"\r\n\t\t\t\t\t\tlabel=\"Motivo para cancelar la cita\"\r\n\t\t\t\t\t\tplaceholder='Ej. \"No puedo asistir\"'\r\n\t\t\t\t\t></CustomFormField>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<SubmitButton\r\n\t\t\t\t\tclassName={`${\r\n\t\t\t\t\t\ttype === 'cancel' ? 'shad-danger-btn' : 'shad-primary-btn'\r\n\t\t\t\t\t} w-full`}\r\n\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t>\r\n\t\t\t\t\t{buttonLabel}\r\n\t\t\t\t</SubmitButton>\r\n\t\t\t\t{form.formState.errors?.root?.serverError.type == 400 && (\r\n\t\t\t\t\t<p className=\"text-sm font-medium text-destructive shad-error\">\r\n\t\t\t\t\t\t{form.formState.errors?.root?.serverError.message}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t)}\r\n\t\t\t</form>\r\n\t\t</Form>\r\n\t);\r\n};\r\n\r\nexport default AppointmentForm;\r\n"
        }
    ]
}